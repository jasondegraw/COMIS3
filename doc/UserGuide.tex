\documentclass[10pt]{book}
\usepackage{amsmath}
\usepackage{mathptmx}
\usepackage{textcmds}
\usepackage{graphicx,color}
\usepackage[margin=1in]{geometry}
\usepackage[all]{xy}
\usepackage{nameref}
\usepackage[colorlinks=true,linkcolor=linkblue]{hyperref}
\definecolor{linkblue}{rgb}{0,0,1}
\usepackage{fancyvrb}
\usepackage{cprotect}
\CustomVerbatimEnvironment{commandline}{Verbatim}{xleftmargin=5mm}
\CustomVerbatimEnvironment{inputfile}{Verbatim}{xleftmargin=5mm}
\CustomVerbatimEnvironment{results}{Verbatim}{xleftmargin=5mm}
\newcommand{\startexample}{Example}
\CustomVerbatimEnvironment{example2}{Verbatim}{formatcom=\makebox[1.5cm][l]{Example},xleftmargin=5mm}
%\newcommand{\customline}[1]{\ifodd\value{FancyVerbLine}\MakeUppercase{#1}\else#1\fi}
%\newenvironment{example3}{\let\FancyVerbFormatLine\oldline%
%\let\customline\FancyVerbFormatLine%
%\begin{BVerbatim}}
%{\end{BVerbatim}%
%\let\oldline\FancyVerbFormatLine}
\newenvironment{example}{\begin{BVerbatim}}{\end{BVerbatim}}
%\newenvironment{note}{\makebox[1.5cm][l]{NOTE:}\hangindent=1.5cm}{}
%\newenvironment{note}{\makebox[1.5cm][l]{NOTE:}\everypar={\hangindent=1.5cm}}{\par}
\newcommand{\hangingpar}[2]{\hangindent#1\hangafter#2\noindent}
\newcommand{\note}[1]{\makebox[1.5cm][l]{NOTE}\hangindent=1.5cm{#1}}
\newenvironment{example1}{Example\begin{verbatim}}{\end{verbatim}}
\newenvironment{hangingpars}[2]{\makebox[1.5cm][l]{NOTE:}\setlength{\parindent}{0pt}\everypar={\hangingpar{#1}{#2}}}{\par}
%\newenvironment{note}{\begin{hangingpars}{1.5cm}{1}}{\end{hangingpars}}
\usepackage{parskip}
\begin{document}
\frontmatter
\begin{titlepage}
%\begin{center}
%\begin{Huge}
%View3D User Manual\\
%\end{Huge}
%\vspace{1cm}
%\begin{Large}
%Version 3.3, Revision 3\\
%\end{Large}
%\vspace{1cm}
%\begin{Large}
%\today
%\end{Large}
%\end{center}

COMIS 3.2 - User Guide 

Edited by: Helmut E. Feustel and Brian V. Smith, LBNL\\
Revised edition by Viktor Dorer, Anne Haas and Andreas Weber, Empa November 01, 2005

Eidgen\"ossische Materialpr\"ufungs-und Forschungsanstalt\\
Laboratoire f\'ed\'eral d'essai des mat\'eriaux et de recherche\\
Laboratorio federale di prova dei materiali e di ricerca\\
Institut federal da controlla da material e da retschertgas\\
Swiss Federal Laboratories for Materials Testing and Research

Empa\\
\"Uberlandstrasse 129\\
CH-8600 D\"ubendorf\\
Tel. +41-1-823 55 11\\
Fax +41-1-821 62 44\\

Energierechengruppe\\
Energiesysteme / Haustechnik

\end{titlepage}
\chapter{PREFACE}
The COMIS workshop (Conjunction of Multizone Infiltration Specialists) was a joint research effort to develop a multizone infiltration model. This workshop (October 1988 -September 1989) was hosted by the Energy Performance of Buildings Group at Lawrence Berkeley Laboratory's Applied Science Division. The task of the workshop was to develop a detailed multizone infiltration program taking crack flow, HVAC-systems, single-sided ventilation and transport mechanism through large openings into account. The agenda integrated all participants' contributions into a single model containing a library of modules. The user-friendly program is aimed at researchers and building professionals. 

The work was accomplished not by investigating numerical description of physical phenomena but by reviewing the literature for the best suitable algorithm. The numerical description of physical phenomena clearly was a task of IEA-Annex 20 ``Air Flow Patterns in Buildings'' which finished in September 1991. In Annex 23 ``Multizone Air Flow Modeling'', which was adopted by the IEA-Energy Conservation in Buildings and Community Systems program in 1992, COMIS has been evaluated by means of tracer gas measurements, wind tunnel data, intermodel comparison, and comparison with analytical solutions. 

From the time of its announcement in December 1986 COMIS was well received by the research community. Due to the internationality of the group, several national and international research programs were co-ordinated with the COMIS workshop. Colleagues from France, Greece, Italy, Japan, The Netherlands, People's Republic of China, Spain, Sweden, Switzerland, and the United States of America were working together on the development of the model and its evaluation. 

Even though this kind of co-operation is well known in other fields of research, e.g., high energy physics, in the field of building physics it is a new approach. 

The COMIS User Guide contains an overview of the COMIS project as well as hints which will be useful in getting through the input and calculation procedure. The handbook comes in loose-leaf form so as to be easily updated according to the progress of the model development. Please note, that the COMIS User Guide reflects the construction of the input .le needed to run the calculation program COMVEN. There are several user interfaces available to create the input file and to run the program. Each interface comes with its own user guide.
\\

Helmut E. Feustel\\
COMIS Co-ordinator and Annex 23 Operating Agent\\ 
Berkeley, California\\
August 31, 1997\\

\section*{Preface to version 3.1} 
This present version of the COMIS User Guide is the result of a major revision undertaken by EMPA. The update has gone together with an effort to debug and streamline the COMIS code, and to make code and User Guide as consistent as possible. 

The changes from COMIS version 3.0 are summarized in chapter 1.4 

This task has been supported by the help and the valuable contributions of: 
Peter G. Schild (NBI, Norway), Brian Smith and Dave Lorenzetti (LBNL, USA), Hans C. Phaff (TNO, The Netherlands), Werner Keilholz ( CSTB, France). 

Viktor Dorer, Anne Haas and Andreas Weber 
Empa Duebendorf, Switzerland 
January 24, 2001 

\section*{Preface to version 3.2}
The new graphical user interface Simulation Studio developed for COMIS by CSTB was the incitement to release a new version of COMIS. The development and improvement of the COMIS code during the last five years since COMIS 3.1 has been released require also a new edition of the User Guide. 

A short description of the Simulation Studio is given in chapter 2.5 and in detail in the Simulation Studio User Guide. The changes of the COMIS code since version 3.1 are summarized in chapter 1.4 

The update to COMIS 3.2 has been supported by the help and the valuable contributions of: 
Peter G. Schild (NBI, Norway) 
Hans C. Pha. (TNO, The Netherlands) 
Werner Keilholz, Paul Sette and Sabine Taristas (CSTB, France) 
Anne Haas (Empa, Switzerland) 

Andreas Weber 
Empa Duebendorf, Switzerland 
November 1, 2005

%\chapter{CONTENTS}
\tableofcontents
\mainmatter
\chapter{INTRODUCTION}
Airflow models can be divided into two main categories, single-zone models and multizone models. Single-zone models assume that the structure can be described by a single, well-mixed zone. The major application for this model type is the single-storey, single family house with no internal partitions (e.g., all internal doors are open). As a large number of buildings, however, have floor plans that would characterize them more accurately as multizone structures, more detailed models, taking internal partitions into account, have been developed.

Even before the advent of physical single-zone models a number of computer models had been developed to calculate the air flow distribution in multizone buildings. In these models the building is described by a set of zones interconnected by flow paths (links). Each zone (node) represents a space with uniform pressure conditions inside or outside the building and the interconnections correspond to impediments to air flow. The network models are usually based on the conservation of mass in each of the zones in the building.

Multizone models are required when there are internal partitions in a building, or in the case of inhomogeneous concentration in the space. Multizone buildings can be either single-room structures (e.g., airplane hangars) single family houses or large building complexes. Figure 1.1 shows an example of a very simple multizone building.

Multizone airflow network models deal with the complexity of flows in a building by recognizing the effects of internal flow restrictions. They require extensive information about flow characteristics and pressure distributions and, in many cases, are too complex to justify their use in predicting flow for simple structures such as single family residences [4].

A literature review undertaken by Feustel and Kendon [17] revealed 26 papers describing 15 different multizone airflow models which had been developed in eight countries. A follow up review [13] carried out in 1992 produced additional information about the status of network models. One of the first to be found was BSRIA's model LEAK by Jackman, which was published in 1970 [21]. Since that time many more models have been developed but many of them have been written as research tools. One of the latest developments in multizone air flow and contaminant transport modeling is the COMIS model [15, 16] which is described here in detail.

\section{The COMIS Project}

Within the Energy Performance of Buildings Group at the Lawrence Berkeley Laboratory LBL (Berkeley, USA), after reviewing the available multizone infiltration models, it was clear that conventional models are not designed to be upgraded to take additional types of flow into account or to improve their usability. Therefore, it was planned to design and develop a model which should contain all the missing features. From the beginning, it was realized that this model development needed a lot of expertise and, equally important, manpower, which would exceed the resources at LBL. 

As a consequence, the group made its plan public and asked interested colleagues to join for a twelve month period for the Conjunction of Multizone Infiltration Specialists to lay the foundation of a versatile multizone infiltration model. In 1986, the first COMIS Newsletter was sent to colleagues to inform them about the joint research project planned at LBL. Even though this kind of cooperation is well established in other fields of research, e.g., high energy physics, in the field of building physics it is new to engage in a research project which one individual or country would not be able to do alone. From the beginning the COMIS idea was well received. Owing to the diverse background of the group several national and international research programs were co-ordinated with the COMIS workshop.

This one year COMIS workshop (Conjunction Of Multizone Infiltration Specialists) was held at the Lawrence Berkeley Laboratory from November 1988 until October 1989. A multinational team developed a new multizone infiltration, ventilation and contaminant transport model, named at that time COMVEN. This model not only takes crack flow into account but also covers flow through large openings, single-sided ventilation, cross ventilation and HVAC-systems. The model was designed to consist of a large number of modules which are managed by a steering program. COMIS can also be used as a basis for future extension in order to increase the ability to simulate buildings.

In parallel, a user interface, developed on FORTRAN 77 basis like the COMVEN code, and a result graphical postprocessor programme on LOTUS spreadsheet basis were developed.

\section{The original COMIS Model (COMIS Version 1.0)}

\subsection{Input}
Special emphasis was given to the input/output routines so that the program should be not only ``user-tolerant'' but ``user-friendly''. It is being developed so it can be used either as a ``stand-alone ventilation model'' or as an ``ventilation module'' of a building simulation program. The input/output procedure is therefore being developed in such a way that either the COMIS in­put/output modules can be used or only the input/output interface. This makes it possible for the user to connect the program with other software (e.g., the building and systems simulations code TRNSYS).

\subsection{Flow through Building Components}
Crack flow, large openings and mechanical ventilation systems can be modelled by COMIS. Furthermore, additional flows which do not influence the pressure distribution in the network in a major way, i.e., simultaneous two way flow at large openings and wind turbulence effect at single-sided windows etc., were studied. Air flow rates through doorways, windows and other common large openings are significant ways in which air, pollutants and thermal energy are transferred from one zone of a building to another.

However, in a previous review of multizone infiltration models, none of the described codes were able to solve this problem in any way other than to divide the large opening into a series of small ones described by crack flow equations.

COMIS's contribution to this fundamental problem was to describe the physical problem, review the various solutions developed in the literature and compare these solutions using both a numerical and a physical point of view [10].

The general laws demonstrated by thermal or fluid mechanics approaches are also valid for large exterior openings in steady state conditions. But none of these methods enables us to quantify the effect of an unsteady wind or large scale turbulence.

Experimental results have shown that these effects can be particularly significant in the case of one-sided ventilation. Nevertheless very few correlations have been proposed and most of those that have concern particular configurations. It seems difficult, therefore, to introduce these effects in a general way in our first model. However, we will hope to do so later on as an improvement to COMIS.

The correction of coefficients of power law for crack flow, taking into account the effect of the temperature distribution of air in the crack, is also studied. The temperature of air flowing through a crack depends on the following factors: 

\begin{itemize}
\item air flow rate,
\item air temperatures of the zones on both sides of the crack,
\item dimensions and form of the crack.
\end{itemize}

In most cases the temperature of the air in a crack is quite different from the temperatures of the zones on either side of the crack. Furthermore, air leakage performance measurements are usually performed in a certain temperature condition but used at different temperatures. The temperature variation, however, has a large influence on the air leakage flow due to changes in the air viscosity and air density. Unfortunately, almost all the models dealing with air leakage characteristics ignore this phenomenon.

Data obtained from measurements on crack models show that, for turbulent crack flow, the mathematical description of the friction factor is identical with the one found for conduit flow with smooth walls. Therefore crack flow can be seen as duct flow with a more complicated flow path.

We found from the crack flow equation research that the flow performance is strongly temperature dependent. In order to arrange the results in the usual form we have introduced correction factors which account for the temperature influence. The correction factor depends on the type of leakage. We have developed three different equations for the different correction factors.

We can easily build an air leakage temperature module according to the crack forms. Fortunately, we found that the crack form mainly depends on the structure of the building or on the type of building component and that its size depends on the workmanship. We therefore classify crack forms into three groups: double frame windows, single frame windows and doors, and walls. 

HVAC-Systems (heating, ventilating and air conditioning systems) are composed of ducts, duct fittings, junctions, fans, air filters, heating and cooling coils, air-to-air heat exchangers, flow controllers, etc. Several of the program modules concerning ventilating systems have already been developed, allowing us to calculate the coefficients of the flow equation for duct works with fittings, the static pressure losses for T-junctions and the volume flow rate of a fan as well as for a flow controller as a function of the pressure difference. Since the duct systems are described by a network in the air flow model the junction is treated as a pressure node.

There are some data available in the literature for the pressure loss coefficients at the T-junction. To our surprise we found that the values of the pressure loss coefficients were significantly different for different sources. For example, in the case of converging flow, the pressure loss coefficient through the main duct of the T-junction obtained from one source is double the value of the loss coefficient given in another.

The fan performance curve is expressed on the basis of more than three data sets of the volume flow rate, and the pressure difference by the polynomial approximate formula using the least square method.

The pressure loss curve for flow controller is expressed by equations based on data sets of the pressure loss and the volume flow rate. The input data is the driving pressure difference of the flow controller. The output data is the volume flow rate.

There are other components connected to the HVAC-Systems which cause dynamic pressure loss, e.g., air filters, heating or cooling coils, different types of junctions, etc. Models for these components are not included in the code yet and have to be considered by defining a dynamic pressure loss factor.

\subsection{Solver}

Calculating the infiltration and ventilation flow rates requires the solution of a non-linear system of equations. The main task has been to find an efficient solving method [10], [20].

A building is basically modeled by pressure nodes that are interconnected with air flow links. For one time step, the outside of the building is represented by a fixed boundary condition. The pressures of the internal nodes in the air flow network have to be solved so as to determine the different air flow rates. Solving these infiltration and ventilation flow rates requires the use of a non-linear system of flow equations. The main task was to find an efficient and stable method.

The starting point is the Newton-Raphson method, with derivatives, operating on a node-oriented network which, in most cases, quickly brings about the convergence of the system of equations. The method has been modified to avoid occasional convergence problems when working with power functions. Fortunately, the origin of the convergence problems is well understood. The solving method works on the flow balance equations and not on the flow equations. If one or several of these balance equations have an exponent close to one-half, the Newton-Raphson method will not work well, due to the nature of the procedure, in finding the next approximation. One instance when this happens is when a leakage opening with a flow exponent of one-half is predominant in one zone. In this case the flow balance equation will also have an exponent close to one-half. An under-relaxation will increase the convergence velocity and bring us to the solution. In principle it is a question of finding an appropriate relaxation coefficient.

\subsection{Wind Pressures}

Another important task in the COMIS workshop was to find a method of determining the wind pressure distribution for a building according to measured data from available literature. This allows building designers to work with the COMIS model even if wind tunnel results are not available for the building under consideration. The pressure distribution around a building is usually described by a dimensionless pressure coefficient (Cp), which is the ratio of the surface pressure and the dynamic pressure in the undisturbed flow pattern, measured at a reference height. From experience we know that wall-averaged values of Cp usually do not match the accuracy required for air flow calculation models.

In order to calculate the Cp-distribution for buildings we provide a method based on a parametrical study to determine the Cp-values [10]. The available methods have been checked by comparing calculated results with findings from wind tunnel tests found in the literature. Since the results did not match the data well, a parametrical analysis of wind tunnel test data, aimed at developing a calculation model for Cp-data, was carried out.

The work on Cp-value calculation has been continued later in the AIOLOS project of the European Commission and resulted in the CPCALC+ code [3].

\subsection{Products of the COMIS workshop}

The major products of the COMIS workshop are: 

\begin{itemize}
\item COMIS simulation code COMVEN
\item COMIS User interface COMIN
\item COMIS Output processor COMOUT
\item COMIS User Guide
\item COMIS Fundamentals [14]
\item Special Issue of the Journal Energy and Buildings [10]
\end{itemize}

\subsection{Follow-Up of COMIS: IEA Annex 23}

Work on the COMIS program did not finish by October 1989. A computer code was available but such a program is ever perfectible. The validation procedure itself is a huge work and was not completed during the COMIS year. Moreover, new knowledge (e.g. from IEA Annex 20) was available after the COMIS workshop finished. This knowledge had to be integrated into the COMIS code.

A roundtable discussion between the COMIS participants and the COMIS review panel about future perspectives revealed a strong feeling that COMIS (or its successor) ought to operate as an international institution with participants committing themselves to a definite work load.

The COMIS group suggested to start a working group under the hospice of IEA's Energy Conservation in Buildings and Community Systems program. The \emph{Multizone Air Flow Modeling} working group was officially adopted in June 1990 as Annex 23. The Annex was supported between 1990 and 1996 by nine participating nations: Belgium, Canada, France, Greece, Italy, Japan, Switzerland, The Netherlands, and USA. The objective of this Annex was to study physical phenomena causing air flow and pollutant transport (e.g., moisture) in multizone buildings and to develop modules to be integrated in a multizone air flow modelling system. Special emphasis was given to the comparison between results from the model and from in-situ measurements.

To reach these objectives the IEA Annex was structured in three subtasks:

\begin{itemize}
\item System development (subtask 1)
\item Data acquisition (subtask 2)
\item System evaluation (subtask 3)
\end{itemize}

Results of these subtasks are addressed to researchers and consultants and contribute to the promotion of an energy efficient design. The Annex participants undertook a task sharing project involving model development, data acquisition and analytical studies.

A close cooperation was envisaged, mainly with regard to state-of-the art reviews, data collection, coordination of work, e.g. defining cases for evaluation purposes with other pertinent projects. The Air Infiltration and Ventilation Centre acted as a vehicle for disseminating the results of this particular Annex. A data base for evaluation purposes was prepared by AIVC and the Centre has collected wind pressure data and leakage data. Algorithms developed by Annex 20 were incorporated into the modelling system. Data obtained for evaluation purposes by this Annex was used for subtask 3. The overlapping in time with Annex 20 guaranteed a sufficient transfer of knowledge.

\subsection{Products of IEA Annex 23}

The major products of IEA Annex 23 are:

\begin{itemize}
\item COMIS 3.0 with graphical /COMIS user interface
\item COMERL user interface
\item User Guides for COMIS, IISiBat/COMIS and COMERL
\item Annex 23 Report `Evaluation of COMIS' [18]
\item Annex 23 Report `Evaluation of COMIS' [19]
\item Special Issue of the Journal Energy and Buildings [11]
\item COMIS Programmer's Guide [8]
\item COMIS Sample Runs [25]
\end{itemize}

Information about COMIS 3.0 can be found under http://epb1.lbl.gov/comis/. 

COMIS 3.0 version is available from the web under http://software.cstb.fr, together with a handbook for the user interface and with a tutorial. 

\section{Subsequent Versions of COMIS}

\subsection{COMIS version 3.1}

In 1999, Empa has officially taken over the maintenance of the COMIS source code from LBNL. LBNL will continue to contribute to the further development of COMIS, but LBNL is not directly involved in the maintenance task anymore. CSTB remains responsible for the IIsibat user interface.

Towards the end of Annex 23, additional contributions to the COMIS code were made in the frame of IEA Annex 27 ``Evaluation and Demonstration of Domestic Ventilation Systems''. Many valuable features were included in the code. However, not all parts were working properly, and the consistency between code and COMIS user guide had diminished noticeably. Together with a list of bugs and other inadequacies in the code, there was a strong need to further improve the COMIS product. 

Therefore, Empa has taken the initiative to update COMIS. With COMIS 3.1 many bugs are fixed, the input formats are consistent and somewhat streamlined where necessary, and the User Guide reflects what the program requires and does.

The update would not have been as profound and extensive without the valuable contributions and help by

\begin{itemize}
\item Peter G. Schild (NBI, Norway)
\item Brian Smith and Dave Lorenzetti (LBNL, USA)
\item Hans C. Pha. (TNO, The Netherlands)
\item Werner Keilholz (CSTB, France)
\end{itemize}

\section{Changes in COMIS version 3.1}

New features, improved features and features which were implemented in the code, but were not yet documented in the User Guide:

Simulation Options: page 52

\verb|&-PR-SIMU|

New option to force pollutant transport output with predefined time step:

\verb|POLSTEP step time step2|

Output Options: page 55

\verb|&-PR-OUTP|

New options: 

On number of Occupant Type n per zone 

\verb|Yn| activitY level factor of occupant Type n per zone 

\verb|Fn| effective Flow with fictive source n per zone 

Control Parameters: page 58

\verb|&-PR-CONTrol|

New solver: solver no. 6. 
Data block 2 changed: Only one flag for initialization at the first and one for the subsequent timesteps and the number of iterations are input. 


Histograms: page 61

\verb|&-HISTO|

Only parameters for the histogram definition. Definition of fictive sources moved to new keyword \verb|&-POL-FIC|. Occupants can be used as weighting factors in histograms.

Pollutant Description: page 125 
Continuation line: 
Definition of fictive sources moved to new keyword \verb|&-POL-FIC|. 

Fictive Source Definition: page 126

\verb|&-POL-FICtive sources|

New keyword for the definition of fictive sources, used for calculation of effective flows.

Zone Layers: page 96 

\verb|&-NET-ZL| has only five input parameters 


Schedules: pages 112, 111 

\verb|&-SCH-OCCupant|, \verb|&-SCH-SOUrce|
Occupant source schedules solely to be defined under \verb|&-SCH-OCC| keyword; Number of occupants implemented in \verb|&-SCH-OCC|.

Wind and Meteo: page 123

\verb|&-ENV-WINd|

Data block 2 has only two input parameters: wind direction angle and wind velocity profile exponent at building location.

Occupants: page 127

\verb|&-OCCUPANt|

New data block 2 with data for the source strength of different pollutants if occupant is used as source. Data in data block 1 starts with *No.

New Histogram output file: page 55 Histograms are not longer written to COF-file, but to a separate file (extension COH).

Naming convention: page 22 \textlangle name\textrangle-xy.COS \textlangle name\textrangle-xy.COH are used for output files instead of xy\textlangle name\textrangle.COS xy\textlangle name\textrangle.COH

There were a number of features implemented in the code which still need further development of algorithms and code and thus are not described in the present user guide. Another number of features which are obsolete but which were still listed in the user guide, were of course also removed in the user guide text. The removed or not operational features are:

\begin{itemize}
\item Duct Fitting
\item Passive Stack
\item Transition
\item HVAC Component
\item Cp Calculation
\end{itemize}

The following keywords are not needed any more

\begin{itemize}
\item\verb|&-CIF|
\item\verb|&-NET-AIR|
\end{itemize}

\section{Changes in COMIS version 3.2}

User Interface:

Completely new graphical user interface Simulation Studio.


New and improved features in the COMIS code:

File structure: page 22 Harmonized output file extension naming: *.COS and *.COH instead of *.CSO and *.CHO for spreadsheet and histogram output files.

Command line: page 23 Improved command line options

Simulation Option: page 55

\verb|&-PR-SIMU|

Output from the ONSCREEN option on the bottom of the window or in a separate window depending on the windows application.

Output Options: page 55

\verb|&-PR-OUTP|

New options: 
DL Calculated Cd values of large openings 
PL Pressure difference across a link 


Duct: page 68

\verb|&-DS|

Zeta value specification for each flow direction separately. 
Zeta value evaluation of fittings depending on flow direction. 
The actual Zeta value can be changed using a link schedule. 


Thermostatic Vent: page 80

\verb|&-TV|

New thermostatic controlled air flow component that changes the flow resistance depending on the flow air temperature.

Large Vertical Openings: page 82

\verb|&-WI|

Flow characteristic of the horizontal pivoting window (LVO-type 2) as a function of opening angle and height to width ratio calibrated with CFD calculated values. New large LVO-type 3: Improved opening geometry for horizontal pivoting axis window. New large LVO-types 4 and 5: Triangles with vertex at the bottom and at the top. COMIS.SET: page 143 Harmonized print-level for output

Bugfixes:

A number of bug.xes have been achieved in COMIS 3.2. Among others:

Allow to position the data set name in \verb|&-CP-VALUes| data section after the second header as it is shown in the example in the User Guide. Changed all default values for the fan curve polynomial coefficients to zero to prevent from

unintended non horizontal or non linear characteristic if the given number of coefficients does not correspond with the defined ``Exp. Polynom.'' parameter.

Allow `\#' also in the \verb|&-PR-OUTP| data section to comment out the rest of the line. `d[e[f[a[u[l[t]]]]]' and `\#' and `;' was not correctly processed in cases where strings had to be read from the CIF (e.g. schedule names).

Introduced a default (` ') for schedule names. 
Default values for time strings introduced. 


Prevent compiler warning of floating point underflow if pollutant concentration approximates zero.
 
Stated gravity constant more precisely. 


Trapped a range check error if too many large openings were defined. 
Units for corrected fan curve slope and intercept in warning message adapted to the corresponding user input units. 


Trapped an integer overflow error if the period between meteo time and start time was too large.
 
Prevent from an integer overflow error on \verb|31dec_23:00| if there is no year specified in the meteo schedule. 

Corrected the dimensions of the array for the filter efficiency data. 

Check and give error message if negative activity level or number of occupants are specified. 

Reset the line counter for CIF lines after rewinding the CIF to ensure a correct line number in error messages. 


Minor change:

The look of messages has changed to be better identified as COMIS messages in coupled calculations with TRNSYS. 

Remaining known issues:

There are still a number of remaining known bugs which not have been fixed in COMIS 3.2 and which the user has to consider in his applications:

Except for cracks, the calculated link temperature does not consider the temperature gradient in layered zones. 

Cd calculation of external windows: Missing error check whether single sided ventilation situation is accomplished.

The results of the very first timestep are not correctly considered in Histogram evaluation. 
Convergency problems with T-junctions. 


\subsection{COMIS 3.2 Documents}

Valid COMIS documents after successful installation in the directory `\textbackslash comis32\textbackslash Documentation':

UserGuide.pdf  User Guide for COMIS 3.2 simulation engine; this document

Tutorial.pdf  Tutorial for COMIS and the Simulation Studio

SimulationStudio.pdf  User Guide for the Simulation Studio

COM-TRN.pdf  User Guide for coupling COMIS and TRNSYS

OutpOpt.pdf  Definition of COMIS output quantities

ProgGuid.txt  Guidelines how to document COMIS program modi.cations

Headers.txt  Sample headers for all keywords;

identical with the ones used throughout this user guide

\subsection{How to get COMIS 3.2}

The new COMIS version is available from CSTB, Sophia Antipolis, France. For more information, see

http://software.cstb.fr

\chapter{GETTING STARTED}

\chapter{BASIC CONCEPTS}

\section{Input Data Structure}

Input data in the CIF-file is arranged according to the following classification:
 
Data group: Data groups are Project, Network, Schedules, Cp-Values, Environment, Pollutant and Occupant (see figure 3.1). Groups are used to improve the user's overview over the necessary data, but the grouping of data need not be reflected in the structure of the input file. The data sections are presented by group in this guide. 

Data section: The description of the simulation model in the input file is divided into data sections. The beginning of each section is characterized by a specific keyword. Keywords are characterized by having an \verb|&| in the first column (example: \verb|&-PR-IDENTification, &-CR|). The structure of data sections is shown for the example in figure 3.2. 

To run a simulation, at minimum one air flow component (from data sections \verb|&-CR| on page 62 to \verb|&-TD| on page 89), one zone (data section \verb|&-NET-ZON| on page 94) and one link (data section \verb|&-NET-LIN| on page 102) must be defined. An example is given in Appendix A.1 on page 132.

Data sections not needed for the actual simulation or consisting of optional parameters only may be entirely omitted. If necessary, internal default values are used to complete the input (e.g. control parameters, ambient conditions, type of output).

Data block: A data section consists of one or more data blocks. A data block has an optional header and can have several data lines.

\note{Data blocks in a data section or data set must be given in the sequence described by the order of the corresponding headers in section 4 in this guide.
Header of data block: For each data block, a header may be given in the input file. The header usually contains information on the data required in the data block: parameter names, units and possibly some further descriptions. This allows for the content of the input file to be self-explanatory. Headers are surrounded by vertical and horizontal bars.}

A header starts with two blanks followed by a row of underscores `\_\_...'. Headers are, preferably, placed close under the keyword.

Headers are provided by the Simulation Studio user interface coming with the official distribution of COMIS. The COMISExcel uses headers, too. See section ``COMIS User Interfaces'' on page 24 for more information. Headers (but not the keywords!) may be omitted by the user while establishing an input file using the screen editor. The headers shown in the keyword description later in this guide are stored in the COMIS simulation engine documents directory in a file called `HEADERS.TXT'.

The units reported in these headers are identified either
\begin{itemize}
\item by a 4-character name of a unit set in section \verb|&-PR-UNITS| or in the set-file, if the unit may beset by the user;
\item by a conventional unit name, if the unit cannot be changed;
\item by a dash, if the quantity has no unit;
\item or by a question mark, if quantities with eventually different units are possible (example: histogram).
\end{itemize}

\chapter{DATA SECTIONS}

In this chapter all input parameters are described in detail. The description of the parameters is structured according to data groups: 
\begin{itemize}
\item Problem description 
\item Network description 
\begin{itemize}
\item Air flow components, Zones, Links 
\end{itemize}
\item Schedules 
\item Cp-Values 
\item Environment description 
\item Pollutant description 
\item Occupant description 
\end{itemize}

It is recommended to follow this sequence of data groups and sections when establishing an input file. If another data section is required before a certain keyword may occur, this is stated in the description of the respective keyword. 

The following sections will show the headers, some example inputs, and explanations of the input. The inputs are shown in typewriter characters. 

\section{Project Description}
\subsection{\&-PR-IDEN tification (Project Identification)}
\begin{inputfile}
&-PR-IDENtification
  ________________ 
 |1.|Problem Name |
 |__|             |
 |________________|
  ________________ 
 |2.|Version Name |
 |__|             |
 |________________|
\end{inputfile}
Example This is an example of the project name. 
You may write text here to describe the project case. 
The maximum number of lines is 10. 

| 
24-June-89 

\note{At least one header line, i.e. one line with first non-blank character `|' must be between description of problem and version name. Otherwise version name is not recognized and the contents of the line is appended to problem name.}
 
Description: 

Parameter Description Default value Input format, range 

Problem Name  short description of project / simulation model  `'  String 800 char  
(10 lines with  
max. 79 characters  
+crlfeach)  
Version Name  version name, date, etc.  `'  String 160 char  

\subsection{\&-PR-UNITS (Project Units)}
\begin{inputfile} 
&-PR-UNITS
  _______________________________ 
 | Unit Conversion Definitions   |
 | Name    |  Input   |  Output  |
 |_________|__________|__________|
\end{inputfile}

\begin{example}
pres  Pa  Pa-OSR  
temp  C  F  
humi  g/kg  g/kg  
INPUT  
cflo  m3/s  
prof  alpha  
OUTPUT  
mean  s
\end{example}

Example 1  pres  Pa  Pa-OSR  
temp  C  F  
humi  g/kg  g/kg  
INPUT  
cflo  m3/s  
prof  alpha  
OUTPUT  
mean  s  

Example 2 	\verb^sour_co2 kg/s mg/s sour_h2o kg/s mg/s sour_odour olf olf conc ppm ppm conc g/kg g/kg conc decipol decipol^

If the keyword INPUT is seen, the units in the following lines are only used for input. Conversely, if the word OUTPUT is seen, the units are used only for output. 

If neither INPUT nor OUTPUT is seen, the first value following the unit identifier is used for input and the second for output. 

The wind velocity profile ``unit'' is available for input only (no profile output).

The air change rate (ach), mean age of air (meanage) and energy units are only available for output and must follow the OUTPUT keyword. All the other units may be used for both input and output conversions.

The data section \verb|&-PR-UNITS| can be used more than once. This allows having different units in different data sections within one input file. The units declared by \verb|&-PR-UNITS| are valid for all data sections following these declarations until the end of the input file or until another unit declaration is encountered that changes the units defined explicitly before.

Description:  
Parameter  Description  
Name Input  identifier for physical quantity; also used as reference in the headers to identify the corresponding quantities; or: keyword INPUT or OUTPUT, if only one unit is given unit for input values  
Output  unit for output values  

Default value - 
see table see table Input format, range 
string element from table below, 4 significant characters; or INPUT or OUTPUT 
string element from table string element from table 

However, it is recommended to use the unit conversion only once per input file. It is also advisable to place the data section \verb|&-PR-UNITS| as early as possible.

The \verb|&-PR-UNITS| input is the preferable method of defining the unit conversions because all information on the simulation situation is fully contained in the input file. It is not recommended to use the COMIS.SET file to define the units (see also appendix C). If units are set in the SET-file, it is impossible to tell which input units were used unless this file is kept with the project files, too.

The values of the quantities listed in the table below can be converted from input units to COMIS internal units, or from COMIS internal units to output units. The internal units are at the same time the default units for input and output. 
%Name Quantity AIRLeakage Air Leakage 
%FLOW Air Flow PRESsure Ventilation Pressure 
%TEMPerature Temperature HUMIdity Humidity SOURce Pollutant Source SINK Pollutant Sink CONCentration Pollut. Concentration 
%VELOcity Wind Speed Input option only CFLOw Component Flow PROFile Pro.le Output option only ACHAnge Air Change Rate MEANage Mean Age of Air ENERgy Energy Default Unit Cm(kg/s@1Pa) 
%kg/s Pa 
%C g/kg kg/s kg/s kg/kg 
%m/s 
%m3/s alpha 
%1/h h KWh Other possibilities kg/h@1Pa, kg/s@10Pa, kg/h@10Pa, dm3/s@1Pa, m3/s@1Pa, m3/h@1Pa, dm3/s@10Pa, m3/s@10Pa, m3/h@10Pa, ELA4, ELA10 g/s, g/h, kg/h, m3/s, dm3/s, dm3/h, m3/h mmH2O, mmHg, inH2O, inHg, hPa, kPa option -OSR to each unit K,F, Ra,Re kg/kg, mass%, %rh g/s, g/h, kg/h, mg/s, ug/s a,olf b g/s, g/h, kg/h, mg/s, ug/s a,olf b g/kg, mg/kg, ug/kg, m3/kg, dm3/kg, ml/kg, ul/kg, mass%, ppm, ppb, part (any rational combination of g, kg, mg, ug, m3, dm3, ml, and ul are possible, 
%e.g. mg/g, dm3/mg) a, decipol b cm/s, kt, ft/min, km/h, mile/h 
%g/s, g/h, kg/s, kg/h, dm3/s, m3/h, dm3/h alpha, z0 
%1/s s J 
%a 
%umeans µ 
%b units for the special pollutant named ODOUR 
%

\note{In the headers all quantities are given with the corresponding unit identifiers to indicate the used input units. For quantities which have only one valid unit, the prescribed unit is given explicitly in the corresponding header. For example, input values for barometric pressure always have to be in kPa. There is also no choice for length input. Depending on the quantity, the unit is always m or mm.}

\note{There is a option `-OSR' which may be appended to the pressure unit (see example). With this option, the outside stack pressure is taken as pressure reference. For further details, see notes on pressure reference on page 33.}

%\makebox[1.5cm][l]{NOTE:}\hangindent=1.5cm Different units for source, sink and concentration may be defined for each pollutant. This is done by entering multiple lines for \verb|sour|, \verb|sink| and \verb|conc| as shown in example 2. As only four characters of the name are used to identify the physical quantity, the name may be longer e.g. to indicate for which pollutant the unit is used. The first unit definition will be used for pollutant number 1, the second for pollutant number 2 and so on. If more than one pollutant unit is entered, but fewer than the number of pollutants defined, then the last line will be used for the unit conversion for the remaining pollutants. If only one line is entered, the same units will be used for all pollutants (so COMIS 3.1 is backwardly compatible with older CIF-files).
\cprotect\note{Different units for source, sink and concentration may be defined for each pollutant. This is done by entering multiple lines for \verb|sour|, \verb|sink| and \verb|conc| as shown in example 2. As only four characters of the name are used to identify the physical quantity, the name may be longer e.g. to indicate for which pollutant the unit is used. The first unit definition will be used for pollutant number 1, the second for pollutant number 2 and so on. If more than one pollutant unit is entered, but fewer than the number of pollutants defined, then the last line will be used for the unit conversion for the remaining pollutants. If only one line is entered, the same units will be used for all pollutants (so COMIS 3.1 is backwardly compatible with older CIF-files).}

\note{The units `olf' for source strength and `decipol' for concentration must be used for the pollutant `ODOUR'. They must be defined for input and output. They must not be used for other pollutants.}


\end{document}
